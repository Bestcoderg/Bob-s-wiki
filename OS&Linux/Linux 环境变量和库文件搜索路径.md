# Linux 环境变量和库文件搜索路径

## Linux可执行文件搜索路径

Linux通过当前用户的环境变量去找可执行文件，按照环境变量提供的顺序，返回第一个找到的符合条件的可执行文件

## Linux库文件搜索路径

### 静态链接

在执行最后一步链接步骤时：

1、ld会去找GCC命令中的参数`-L`所定义的库文件目录

2、再找gcc的环境变量`LIBRARY_PATH`

3、再找内定目录 `/lib`、 /`usr/lib`、 `/usr/local/lib` 这是当初compile gcc时写在程序内的

### 动态链接

1、编译目标代码时指定的动态库搜索路径；

2、环境变量`LD_LIBRARY_PATH`指定的动态库搜索路径；

3、配置文件`/etc/ld.so.conf`中指定的动态库搜索路径；

4、默认的动态库搜索路径/`lib`；

5、默认的动态库搜索路径/`usr/lib`。

其中：

LIBRARY_PATH环境变量：指定程序静态链接库文件搜索路径

LD_LIBRARY_PATH环境变量：指定程序动态链接库文件搜索路径

## **连接和运行时库文件搜索路径**

库文件在连接（静态库和共享库）和运行（仅限于使用共享库的程序）时被使用，其搜索路径是在系统中进行设置的。一般 Linux 系统把 /lib 和 /usr/lib 两个目录作为默认的库搜索路径，所以使用这两个目录中的库时不需要进行设置搜索路径即可直接使用。对于处于默认库搜索路径之外的库，需要将库的位置添加到库的搜索路径之中。设置库文件的搜索路径有下列两种方式，可任选其一使用：

(1). 在 /etc/ld.so.conf 文件中添加库的搜索路径。(或者在/etc/ld.so.conf.d 下新建一个.conf文件，将搜索路径一行一个加入-junziyang)将自己可能存放库文件的路径都加入到/etc /ld.so.conf中是明智的选择添加方法也极其简单，将库文件的绝对路径直接写进去就OK了，一行一个。

在程序连接时，对于库文件（静态库和共享库）的搜索路径，除了上面的设置方式之外，还可以通过 -L 参数显式指定。因为用 -L 设置的路径将被优先搜索，所以在连接的时候通常都会以这种方式直接指定要连接的库的路径。这种设置方式需要 root 权限，以改变 /etc/ld.so.conf 文件并执行 /sbin/ldconfig 命令

(2). 在环境变量 LD_LIBRARY_PATH 中指明库的搜索路径。